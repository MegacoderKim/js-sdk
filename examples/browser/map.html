<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>HyperTrack map</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet-src.js"></script>
    <script src="../node_modules/leaflet.markerCluster/dist/leaflet.markercluster.js"></script>
    <script src="../node_modules/whatwg-fetch/fetch.js"></script>
    <script src="http://cdn.date-fns.org/v1.0.0/date_fns.min.js"></script>
    <script src="../node_modules/rxjs/bundles/Rx.min.js"></script>
    <script src="../node_modules/leaflet.heat/dist/leaflet-heat.js"></script>
    <!--<script src="../node_modules/moment-mini/moment.min.js"></script>-->
    <script src="../node_modules/underscore/underscore-min.js"></script>
    <script src="../node_modules/time-aware-polyline/dist/time-aware-polyline_browser.js"></script>
    <script src="../node_modules/ht-utility/dist/ht-utility_browser.js"></script>
    <script src="../node_modules/ht-data/dist/ht-data_browser.js"></script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBtboBD4lM6hMR02qtUjJHua9gFs6PFbQE&libraries=geometry,visualization"></script>
    <script src="http://googlemaps.github.io/js-rich-marker/src/richmarker-compiled.js"></script>
    <script src="../js-libs/richmarkers.js"></script>
    <script src="../node_modules/ht-maps/dist/ht-maps_browser.js"></script>
    <script src="../node_modules/ht-client/dist/ht-client_browser.js"></script>
    <link rel="stylesheet" href="../node_modules/ht-maps/dist/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css">
    <style>
        #map {
            height: 400px;
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        @keyframes pulse {
            0% {
                transform: scale(0.3, 0.3);
                opacity: 0.9;
            }

            100% {
                transform: scale(3,3);
                opacity: 0;
            }
        }
        .pulse {
            background: #52616A;
             border-radius: 50%;
             height: 50px;
             width: 50px;
            -webkit-animation: pulse 2s ease-out;
            animation: pulse 2s ease-out;
            -webkit-animation-iteration-count: infinite;
            animation-iteration-count: infinite;
             position: absolute;
             top: 0px;
             z-index: -1;
             opacity: 1;
             pointer-events: none;
        }

    </style>
    <link rel="stylesheet" href="../node_modules/font-awesome/css/font-awesome.css">

</head>
<body>
<div id="map"></div>
<script>

    // var token = "sk_55fc65eb64c0b10300c54ff79ea3f6ef22981793";
    //
    // var userId = "44e37638-0bd9-428a-9d74-556092ac712a";
    //
    htMaps.mapTypeService.getInstance('leaflet');
    var mapClass = new htMaps.HtMapClass('leaflet');

    mapClass.initMap(document.getElementById('map'));
    const mapUtils = mapClass.mapInstance.mapUtils;
    var map = mapClass.map;
    var r
    setTimeout(function() {
        r = mapUtils.getDivMarker();
        mapUtils.setDivContent(r, '<div class="pulse"></div>');
        // r.setContent('<div class="pulse"></div>');
        r.setLatLng(map.getCenter());
        r.addTo(map)
    }, 1000)

    // var client = new htClient.initClient(token);
    //
    // var users = htClient.usersClientFactory();
    //
    // users.listAll.setActive();
    //
    // mapClass.usersCluster.setData$(users.listAll.dataArray$);

</script>

</body>